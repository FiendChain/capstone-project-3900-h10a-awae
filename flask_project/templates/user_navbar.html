<!--Search bar functionality changes depending on context-->
<script>
$("document").ready(function () {
  $("#search-bar-nav").keypress(function (ev) {
    // TODO: Get this working from homepage
    // check if the enter key pressed
    var keycode = (ev.keyCode ? ev.keyCode : ev.which);
    if(keycode != 13){
      return;
    }

    let search = $(this);
    let linked_form = search.attr("form");
    let form = $(`form#${linked_form}`);

    // if form doesn't exist, then we go to the product page
    if (form.length === 0) {
      let url = "{{ url_for("user_bp.search") }}";
      let qstring = new URLSearchParams({"name": search.val()}).toString();
      //window.location.href = `${url}?${qstring}`;
    } else {

    }
  });
});
</script>

<!--Header-->
<header class="navbar navar-expand flex-column">
  <div class="row w-100">
    <!--Search bar-->
    <div class="col align-self-start text-left">
      <!--This links to the product search form-->
      <div class="w-75 d-flex align-items-center">
        <input 
          type="search" class="form-control" id="search-bar-nav" placeholder="Search..." aria-label="Search for..." autocomplete="off" spellcheck="false" 
          form="product-search-form" name="name">
      </div>
    </div>
    <div class="col align-self-center text-center">
      <a href="{{ url_for("user_bp.home") }}">
        <h2>Cafe AWAE</h2>
      </a>
    </div>
    <!--Controls-->
    <div class="col align-self-end text-right">
      <div>
        <a href='{{ url_for('user_bp.cart') }}'>
          <div class="btn btn-primary">Cart</div>
        </a>
        <a href='{{ url_for('user_bp.login') if not current_user.is_authenticated else url_for('user_bp.profile') }}'>
          <div class="btn btn-primary">Profile</div>
        </a>
        {% if current_user.is_authenticated %}
        <a href='{{ url_for('user_bp.logout') }}'>
          <div class="btn btn-primary">Logout</div>
        </a>
        {% endif %}
      </div>
    </div>
  </div>
</header>
